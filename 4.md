
# <span style="color:orange">INSTALACIÓN RAIDS Y VOLÚMENES LÓGICOS</span>

## <span style="color:orange">INTRODUCCIÓN</span>

La redundancia aporta un nivel más de seguridad en caso de perdida de datos o de rotura de soportes de almacenamiento, la llevaremos a cabo implementando un RAID 10 que la gestionaremos con un volumen lógico.

## <span style="color:orange">DESARROLLO</span>

Hemos añadido 4 discos de 5 GB cada uno, la estructura es la siguiente:

``` 
sdb         8:16   0     5G  0 disk  
sdc         8:32   0     5G  0 disk  
sdd         8:48   0     5G  0 disk  
sde         8:64   0     5G  0 disk  
```

El primer paso es crear el RAID 10, que los haremos creando dos RAID 1 y un RAID 0. Con el siguiente comando le indicamos que cree un RAID 1 con el nombre md0 y que utilice 2 dispositivos (sdc y sdb).


``` bash
$sudo mdadm --create /dev/md0 --level=1 --raid-devices=2 /dev/sdc /dev/sdb
```

Realizamos el mismo comando cambiando el nombre y los dispositivos para el resto de RAIDS:

`RAID 1:`
```bash
$sudo mdadm --create /dev/md1 --level=1 --raid-devices=2 /dev/sdb /dev/sde
```

`RAID 0:`
```bash
$sudo mdadm --create /dev/md2 --level=0 --raid-devices=2 /dev/md0 /dev/md1
```

Para comprobar que se han  formado bien, ejecutamos el comando `sudo mdadm --detail md126`

```bash
/dev/md126:
           Version : 1.2
     Creation Time : Thu Oct  5 12:43:08 2023
        Raid Level : raid1
        Array Size : 5237760 (5.00 GiB 5.36 GB)
     Used Dev Size : 5237760 (5.00 GiB 5.36 GB)
      Raid Devices : 2
     Total Devices : 3
       Persistence : Superblock is persistent

       Update Time : Thu Oct  5 13:10:19 2023
             State : clean 
    Active Devices : 2
   Working Devices : 3
    Failed Devices : 0
     Spare Devices : 1

Consistency Policy : resync

              Name : machancoses-VirtualBox:0  (local to host machancoses-VirtualBox)
              UUID : 2e06b46f:b2c656ac:8a221560:e93b8950
            Events : 21

    Number   Major   Minor   RaidDevice State
       0       8       32        0      active sync   /dev/sdc
       1       8       16        1      active sync   /dev/sdb

       2       8       80        -      spare   /dev/sdf

```
Otro comando útil para listar los dicos es el comando `lsblk`

```bash
sdb         8:16   0     5G  0 disk  
└─md126     9:126  0     5G  0 raid1 
  └─md125   9:125  0    10G  0 raid0 
sdc         8:32   0     5G  0 disk  
└─md126     9:126  0     5G  0 raid1 
  └─md125   9:125  0    10G  0 raid0 
sdd         8:48   0     5G  0 disk  
└─md127     9:127  0     5G  0 raid1 
  └─md125   9:125  0    10G  0 raid0 
sde         8:64   0     5G  0 disk  
└─md127     9:127  0     5G  0 raid1 
  └─md125   9:125  0    10G  0 raid0 
```
Dentro del archivo `/etc/mdadm/mdadm.conf` podemos ver información adicional como el UID de los RAID. 

```
ARRAY /dev/md0 metadata=1.2 name=machancoses-VirtualBox:0 UUID=2e06b46f:b2c656ac:8a221560:e93b8950
ARRAY /dev/md1 metadata=1.2 name=machancoses-VirtualBox:1 UUID=cc3809e9:29204d35:75d6eb4e:9acd8971
ARRAY /dev/md2 metadata=1.2 name=machancoses-VirtualBox:2 UUID=252b2ec6:e372984b:97bc8397:d3f22330
```

Vamos a darle el formato ext4 al RAID con el comando:

```bash
$mkfs.ext4 /dev/md2
```













































